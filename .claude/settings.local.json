{
  "permissions": {
    "allow": [
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"PGPASSWORD=''UniformesCloud2025'' psql -h localhost -U uniformes_user -d uniformes_db -c \"\"\n-- Ver los valores actuales del enum\nSELECT unnest(enum_range(NULL::sale_source_enum));\n\"\"\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git status\")",
      "Bash(git commit:*)",
      "Bash(git push:*)",
      "Bash(npm run build:*)",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"PGPASSWORD=''UniformesCloud2025'' psql -h localhost -U uniformes_user -d uniformes_db -c \"\"ALTER TABLE orders ALTER COLUMN user_id DROP NOT NULL;\"\"\")",
      "Bash(git add:*)",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git pull origin develop\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git checkout -- . && git pull origin develop\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"systemctl restart uniformes-api && sleep 3 && systemctl status uniformes-api --no-pager\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 'curl -s -X POST http://localhost:8000/api/v1/portal/orders/create \\\n  -H \"\"Content-Type: application/json\"\" \\\n  -d \"\"{\n    \\\"\"school_id\\\"\": \\\"\"050f6088-9ae2-41a3-a415-84c669250169\\\"\",\n    \\\"\"client_id\\\"\": \\\"\"6741a5e3-4f6e-44de-821d-239240b8bd68\\\"\",\n    \\\"\"items\\\"\": [{\n      \\\"\"garment_type_id\\\"\": \\\"\"4b8d72d6-2b63-45d7-8555-34f56cd3f17a\\\"\",\n      \\\"\"quantity\\\"\": 1,\n      \\\"\"unit_price\\\"\": 50000,\n      \\\"\"size\\\"\": \\\"\"M\\\"\"\n    }]\n  }\"\"')",
      "Bash(grep:*)",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"PGPASSWORD=''UniformesCloud2025'' psql -h localhost -U uniformes_user -d uniformes_db -c \"\"\nINSERT INTO garment_types (id, school_id, name, description, category, requires_embroidery, has_custom_measurements, is_active, created_at, updated_at) VALUES \n(''36639e03-ee1c-4248-94df-403068b8d34b'', ''050f6088-9ae2-41a3-a415-84c669250169'', ''Blusa'', ''Blusa escolar'', ''superior'', false, false, true, NOW(), NOW()),\n(''956455c4-8fe2-4726-8306-5b668a0d804b'', ''050f6088-9ae2-41a3-a415-84c669250169'', ''Jean'', ''Jean escolar'', ''inferior'', false, false, true, NOW(), NOW()),\n(''8bed1b8a-74aa-4547-b4e9-00d66df8d359'', ''050f6088-9ae2-41a3-a415-84c669250169'', ''Medias'', ''Medias escolares'', ''accesorio'', false, false, true, NOW(), NOW()),\n(''5b1f183e-4ac5-4136-9d74-14596ca4f4d4'', ''050f6088-9ae2-41a3-a415-84c669250169'', ''Tennis'', ''Tennis escolares'', ''calzado'', false, false, true, NOW(), NOW()),\n(''d57c4c0c-0ec5-4daa-88ac-fd45a66b3361'', ''050f6088-9ae2-41a3-a415-84c669250169'', ''Zapatos'', ''Zapatos escolares'', ''calzado'', false, false, true, NOW(), NOW())\nON CONFLICT (id) DO NOTHING;\n\"\"\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"PGPASSWORD=''UniformesCloud2025'' psql -h localhost -U uniformes_user -d uniformes_db -c \"\"\n\\d order_items\n\"\" | grep -A 5 ''Foreign-key''\")",
      "Bash(git commit -m \"$(cat <<''EOF''\nfeat: Restructure order system with 3 order types (catalog, yomber, custom)\n\n- Backend: Update OrderItemCreate schema with order_type, product_id, additional_price\n- Backend: Replace hardcoded $50,000 price with type-based pricing logic\n- Frontend: Add OrderType, YomberMeasurements types to api.ts\n- Frontend: Create YomberMeasurementsForm component for yomber orders\n- Frontend: Refactor OrderModal with 3 tabs (CatÃ¡logo, Yomber, Personalizado)\n- Frontend: Create WebOrders page to manage web portal orders\n- Frontend: Add /web-orders route and navigation link\n\nOrder types:\n- Catalog: Price from selected product (out-of-stock items)\n- Yomber: Base product price + additional services + required measurements\n- Custom: Manual price entry for special items\nEOF\n)\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"journalctl -u uniformes-api -n 50 --no-pager\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"journalctl -u uniformes-api --since ''10 minutes ago'' --no-pager | grep -i ''error\\|500\\|traceback'' -A 5\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"cd /var/www/uniformes-system-v2/backend && source venv/bin/activate && PGPASSWORD=''$Un1f0rm3s2024!'' psql -h localhost -U uniformes_user -d uniformes_db -c \"\"SELECT id, code, source, user_id, created_at FROM orders ORDER BY created_at DESC LIMIT 10;\"\"\")",
      "Bash(source venv/bin/activate)",
      "Bash(python:*)",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 'sudo -u postgres psql -d uniformes_db -c \"\"SELECT enumlabel FROM pg_enum WHERE enumtypid = (SELECT oid FROM pg_type WHERE typname = ''''order_item_status_enum'''');\"\"')",
      "Bash(ssh root@104.156.247.226 \"tail -300 /var/log/uniformes/backend.log 2>/dev/null | grep -A5 ''receivables-payables\\|/receivables\\|/payables'' | tail -40\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git pull origin develop && cd frontend && npm run build && sudo systemctl restart nginx\")",
      "Bash(ssh root@104.156.247.226 \"tail -500 /var/log/uniformes/backend.log 2>/dev/null | grep -i ''422\\|validation\\|unprocessable'' | tail -20\")",
      "Bash(npx tsc:*)",
      "Bash(ssh root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git pull origin develop && systemctl restart uniformes-api\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"sudo -u postgres psql -d uniformes_db -c \"\"ALTER TYPE acc_payment_method_enum ADD VALUE IF NOT EXISTS ''NEQUI'';\"\"\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"sudo -u postgres psql -d uniformes_db -c \"\"SELECT enumlabel FROM pg_enum WHERE enumtypid = (SELECT oid FROM pg_type WHERE typname = ''payment_method_enum'');\"\"\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"sudo systemctl restart uniformes-api && sleep 2 && sudo systemctl status uniformes-api | head -15\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"journalctl -u uniformes-api -n 10 --no-pager\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git pull origin develop && cd backend && source venv/bin/activate && pip install -r requirements.txt --quiet && sudo systemctl restart uniformes-api && sleep 2 && sudo systemctl status uniformes-api | head -15\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git pull origin develop && sudo systemctl restart uniformes-api && sleep 2 && sudo systemctl status uniformes-api | head -10\")",
      "Bash(ssh root@104.156.247.226:*)",
      "Bash(curl:*)",
      "Bash(python3:*)",
      "Bash(pip3 install:*)",
      "Bash(ls:*)",
      "Bash(echo:*)",
      "Bash(/bin/echo:*)",
      "Bash(ssh root@104.156.247.226 \"journalctl -u uniformes-api -n 15 --no-pager | grep -A 5 -B 5 ''verify-email''\")",
      "Bash(ssh root@104.156.247.226 \"cat /etc/nginx/sites-available/uniformes\")",
      "Bash(ssh root@104.156.247.226 \"journalctl -u uniformes-api -n 50 --no-pager | tail -30\")",
      "Bash(ssh root@104.156.247.226 \"journalctl -u uniformes-api -n 100 --no-pager | grep -i ''email\\|resend\\|verification'' | tail -20\")",
      "Bash(npm run type-check:*)",
      "Bash(ssh root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git pull origin develop && cd web-portal && npm run build && pm2 restart uniformes-web\")",
      "Bash(npm run:*)",
      "Bash(ssh root@104.156.247.226 \"ls -lah /var/www/uniformes-system-v2/web-portal/public/school-logos/\")",
      "Bash(ssh root@104.156.247.226 \"cat /var/www/uniformes-system-v2/web-portal/app/page.tsx | sed -n ''160,200p''\")",
      "Bash(find:*)",
      "Bash(git commit -m \"$(cat <<''EOF''\nfix: Use correct school slugs from database for logo mapping\n\n- Add is_active check in authenticate_web_client method\n- Prevents deleted (inactive) clients from logging into web portal\n- Returns None if client.is_active is False\n- Fixes security issue where soft-deleted clients could still access portal\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(git commit -m \"$(cat <<''EOF''\nfix: Remove duplicate Depends() in upload_payment_proof endpoint\n\n- DatabaseSession already includes Depends via Annotated\n- Cannot specify Depends both in Annotated and as default value\n- Fixes FastAPI startup crash\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(ssh:*)",
      "Bash(ssh root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git pull origin develop && systemctl restart uniformes-api && sleep 3 && systemctl status uniformes-api\")",
      "Bash(from origin 'https://uniformesconsuelorios.com' has been blocked)",
      "Bash(by CORS policy: No 'Access-Control-Allow-Origin' header\"\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(cat:*)",
      "Bash(backend/app/models/product.py )",
      "Bash(backend/app/models/__init__.py )",
      "Bash(backend/app/schemas/product.py )",
      "Bash(backend/app/api/routes/products.py )",
      "Bash(backend/alembic/versions/m7n8o9p0q1r2_add_garment_type_images.py )",
      "Bash(frontend/src/utils/api-client.js )",
      "Bash(frontend/src/services/productService.js )",
      "Bash(frontend/src/components/GarmentTypeModal.tsx )",
      "Bash(frontend/src/pages/Products.tsx )",
      "Bash(web-portal/lib/api.ts )",
      "Bash(web-portal/components/ProductImageGallery.tsx )",
      "Bash(\"web-portal/app/[school_slug]/page.tsx\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o ConnectTimeout=10 root@104.156.247.226 \"echo ''Connected successfully'' && cd /var/www/uniformes-system-v2 && git status\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o ConnectTimeout=10 root@104.156.247.226 \"echo ''Connected!'' && cd /var/www/uniformes-system-v2 && git pull origin develop 2>&1\")",
      "Bash(expect -c '\nset timeout 60\nspawn ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226\nexpect \"\"password:\"\"\nsend \"\"2-jR5H2g*XfY\\\\$tD4\\\\r\"\"\nexpect \"\"# \"\"\nsend \"\"systemctl restart uniformes-api && systemctl status uniformes-api --no-pager\\\\r\"\"\nexpect \"\"# \"\"\nsend \"\"exit\\\\r\"\"\nexpect eof\n')",
      "Bash(expect -c '\nset timeout 300\nspawn ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226\nexpect \"\"password:\"\"\nsend \"\"2-jR5H2g*XfY\\\\$tD4\\\\r\"\"\nexpect \"\"# \"\"\nsend \"\"cd /var/www/uniformes-system-v2/web-portal && npm run build 2>&1 | tail -20\\\\r\"\"\nexpect -timeout 300 \"\"# \"\"\nsend \"\"pm2 restart uniformes-web && pm2 status\\\\r\"\"\nexpect \"\"# \"\"\nsend \"\"exit\\\\r\"\"\nexpect eof\n')",
      "Bash(expect -c '\nset timeout 30\nspawn ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226\nexpect \"\"password:\"\"\nsend \"\"2-jR5H2g*XfY\\\\$tD4\\\\r\"\"\nexpect \"\"# \"\"\nsend \"\"curl -s http://localhost:8000/api/v1/schools | python3 -c \\\\\"\"import sys,json; d=json.load\\(sys.stdin\\); print\\(f\\\\\\\\\\\\\"\"Schools: {len\\(d\\)}\\\\\\\\\\\\\"\"\\)\\\\\"\"\\\\r\"\"\nexpect \"\"# \"\"\nsend \"\"exit\\\\r\"\"\nexpect eof\n')",
      "Bash(expect -c '\nset timeout 30\nspawn ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226\nexpect \"\"password:\"\"\nsend \"\"2-jR5H2g*XfY\\\\$tD4\\\\r\"\"\nexpect \"\"# \"\"\nsend \"\"sudo -u postgres psql uniformes_db -c \\\\\"\"\\\\\\\\\\\\\\\\dt garment_type_images\\\\\"\"\\\\r\"\"\nexpect \"\"# \"\"\nsend \"\"exit\\\\r\"\"\nexpect eof\n')",
      "Bash(expect -c '\nset timeout 30\nspawn ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226\nexpect \"\"password:\"\"\nsend \"\"2-jR5H2g*XfY\\\\$tD4\\\\r\"\"\nexpect \"\"# \"\"\nsend \"\"sudo -u postgres psql uniformes_db -t -c \\\\\"\"SELECT table_name FROM information_schema.tables WHERE table_name = '\\\\''garment_type_images'\\\\\\\\''\\\\\"\"\\\\r\"\"\nexpect \"\"# \"\"\nsend \"\"exit\\\\r\"\"\nexpect eof\n')",
      "Bash(expect -c '\nset timeout 30\nspawn ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226\nexpect \"\"password:\"\"\nsend \"\"2-jR5H2g*XfY\\\\$tD4\\\\r\"\"\nexpect \"\"# \"\"\nsend \"\"PGPASSWORD=unicolor2022 psql -U uniformes_user -h localhost uniformes_db -t -c \\\\\"\"SELECT COUNT\\(*\\) FROM garment_type_images;\\\\\"\"\\\\r\"\"\nexpect \"\"# \"\"\nsend \"\"exit\\\\r\"\"\nexpect eof\n')",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 'bash -c ''''\nTOKEN=$\\(curl -s -X POST http://localhost:8000/api/v1/auth/login -H \"\"Content-Type: application/json\"\" -d \"\"{\\\\\"\"email\\\\\"\":\\\\\"\"admin@uniformes.com\\\\\"\",\\\\\"\"password\\\\\"\":\\\\\"\"admin123\\\\\"\"}\"\" | python3 -c \"\"import sys,json; print\\(json.load\\(sys.stdin\\).get\\(\\\\\"\"access_token\\\\\"\",\\\\\"\"\\\\\"\"\\)\\)\"\"\\)\ncurl -s \"\"http://localhost:8000/api/v1/garment-types\"\" -H \"\"Authorization: Bearer $TOKEN\"\" | python3 -c \"\"import sys,json; d=json.load\\(sys.stdin\\); print\\(f\\\\\"\"Garment Types: {len\\(d\\)}\\\\\"\"\\); print\\(f\\\\\"\"First type has images field: {bool\\(d\\) and '\\\\''images'\\\\\\\\'' in d[0]}\\\\\"\" if d else \\\\\"\"No types\\\\\"\"\\)\"\"\n''''')",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 'bash -c ''''\nTOKEN=$\\(curl -s -X POST http://localhost:8000/api/v1/auth/login -H \"\"Content-Type: application/json\"\" -d \"\"{\\\\\"\"email\\\\\"\":\\\\\"\"admin@uniformes.com\\\\\"\",\\\\\"\"password\\\\\"\":\\\\\"\"admin123\\\\\"\"}\"\" | python3 -c \"\"import sys,json; print\\(json.load\\(sys.stdin\\).get\\(\\\\\"\"access_token\\\\\"\",\\\\\"\"\\\\\"\"\\)\\)\"\"\\)\ncurl -s \"\"http://localhost:8000/api/v1/garment-types\"\" -H \"\"Authorization: Bearer $TOKEN\"\" | python3 -c \"\"import sys,json\nd=json.load\\(sys.stdin\\)\nprint\\(f\\\\\"\"Garment Types: {len\\(d\\)}\\\\\"\"\\)\nif d:\n    print\\(f\\\\\"\"Has images field: {\\\\\"\"images\\\\\"\" in d[0]}\\\\\"\"\\)\n    print\\(f\\\\\"\"Has primary_image_url field: {\\\\\"\"primary_image_url\\\\\"\" in d[0]}\\\\\"\"\\)\n    print\\(f\\\\\"\"First type name: {d[0].get\\(\\\\\"\"name\\\\\"\"\\)}\\\\\"\"\\)\"\"\n''''')",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 'bash -c ''''\nTOKEN=$\\(curl -s -X POST http://localhost:8000/api/v1/auth/login -H \"\"Content-Type: application/json\"\" -d \"\"{\\\\\"\"email\\\\\"\":\\\\\"\"admin@uniformes.com\\\\\"\",\\\\\"\"password\\\\\"\":\\\\\"\"admin123\\\\\"\"}\"\" | python3 -c \"\"import sys,json; print\\(json.load\\(sys.stdin\\).get\\(\\\\\"\"access_token\\\\\"\",\\\\\"\"\\\\\"\"\\)\\)\"\"\\)\ncurl -s \"\"http://localhost:8000/api/v1/garment-types\"\" -H \"\"Authorization: Bearer $TOKEN\"\" | python3 << PYTHON\nimport sys, json\nd = json.load\\(sys.stdin\\)\nprint\\(f\"\"Garment Types: {len\\(d\\)}\"\"\\)\nif d:\n    has_images = \"\"images\"\" in d[0]\n    has_primary = \"\"primary_image_url\"\" in d[0]\n    print\\(f\"\"Has images field: {has_images}\"\"\\)\n    print\\(f\"\"Has primary_image_url field: {has_primary}\"\"\\)\n    print\\(f\"\"First type: {d[0].get\\(\\\\\"\"name\\\\\"\"\\)}\"\"\\)\nPYTHON\n''''')",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 'curl -s -X POST http://localhost:8000/api/v1/auth/login -H \"\"Content-Type: application/json\"\" -d \"\"{\\\\\"\"email\\\\\"\":\\\\\"\"admin@uniformes.com\\\\\"\",\\\\\"\"password\\\\\"\":\\\\\"\"admin123\\\\\"\"}\"\" | head -200')",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"curl -s http://localhost:8000/api/v1/schools\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"journalctl -u uniformes-api -n 50 --no-pager\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"cat /var/www/uniformes-system-v2/backend/.env | grep DATABASE\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"systemctl restart uniformes-api\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"curl -s http://localhost:8000/api/v1/schools | head -200\")",
      "Bash(SSHPASS='2-jR5H2g*XfY$tD4' sshpass -e ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o ConnectTimeout=20 root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git pull origin develop && source backend/venv/bin/activate && TEST_DATABASE_URL=''postgresql+asyncpg://uniformes_user:Uniformes2025@localhost:5432/uniformes_test'' python -m pytest backend/tests/api/ -v --tb=short 2>&1 | head -300\")",
      "Bash(SSHPASS='2-jR5H2g*XfY$tD4' sshpass -e ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o ConnectTimeout=20 root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git pull origin develop && source backend/venv/bin/activate && TEST_DATABASE_URL=''postgresql+asyncpg://uniformes_user:Uniformes2025@localhost:5432/uniformes_test'' python -m pytest backend/tests/api/test_clients_routes.py::TestClientCreation::test_create_client_success -v --tb=long 2>&1\")",
      "Bash(SSHPASS='2-jR5H2g*XfY$tD4' sshpass -e ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o ConnectTimeout=20 root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git pull origin develop && source backend/venv/bin/activate && TEST_DATABASE_URL=''postgresql+asyncpg://uniformes_user:Uniformes2025@localhost:5432/uniformes_test'' python -m pytest backend/tests/api/ -v --tb=line 2>&1 | head -300\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"PGPASSWORD=Uniformes2025 psql -h localhost -U uniformes_user -d uniformes_db -c \"\"INSERT INTO schools \\(code, name, slug, is_active\\) VALUES \\(''CONFAMA-001'', ''CONFAMA'', ''confama'', true\\) RETURNING id, code, name, slug;\"\"\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"PGPASSWORD=Uniformes2025 psql -h localhost -U uniformes_user -d uniformes_db -c \"\"INSERT INTO schools \\(id, code, name, slug, is_active\\) VALUES \\(gen_random_uuid\\(\\), ''CONFAMA-001'', ''CONFAMA'', ''confama'', true\\) RETURNING id, code, name, slug;\"\"\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"PGPASSWORD=Uniformes2025 psql -h localhost -U uniformes_user -d uniformes_db -c \"\"INSERT INTO schools \\(id, code, name, slug, is_active, created_at, updated_at\\) VALUES \\(gen_random_uuid\\(\\), ''CONFAMA-001'', ''CONFAMA'', ''confama'', true, NOW\\(\\), NOW\\(\\)\\) RETURNING id, code, name, slug;\"\"\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"PGPASSWORD=Uniformes2025 psql -h localhost -U uniformes_user -d uniformes_db -c \"\"SELECT p.id, p.code, p.name, gt.name as tipo_prenda, p.size, p.price, s.name as colegio FROM products p JOIN garment_types gt ON p.garment_type_id = gt.id LEFT JOIN schools s ON p.school_id = s.id ORDER BY s.name, gt.name, p.size LIMIT 50;\"\"\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"PGPASSWORD=Uniformes2025 psql -h localhost -U uniformes_user -d uniformes_db -c \"\"SELECT id, name, is_global FROM garment_types WHERE is_global = true OR name IN \\(''Camiseta'', ''Sudadera'', ''Chompa''\\);\"\"\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"PGPASSWORD=Uniformes2025 psql -h localhost -U uniformes_user -d uniformes_db -c \"\"SELECT id, name, school_id FROM garment_types;\"\"\")",
      "Bash(SSHPASS='2-jR5H2g*XfY$tD4' sshpass -e ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o ConnectTimeout=20 root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git pull origin develop && source backend/venv/bin/activate && TEST_DATABASE_URL=''postgresql+asyncpg://uniformes_user:Uniformes2025@localhost:5432/uniformes_test'' python -m pytest backend/tests/api/ -v --tb=line 2>&1 | head -200\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"PGPASSWORD=Uniformes2025 psql -h localhost -U uniformes_user -d uniformes_db << ''EOF''\n-- Obtener el ID de CONFAMA\nDO $$\nDECLARE\n    confama_id UUID := ''45a33bc8-a732-4208-b99f-91f100077114'';\n    camiseta_id UUID;\n    sudadera_id UUID;\n    chompa_id UUID;\nBEGIN\n    -- Crear tipos de prenda para CONFAMA\n    INSERT INTO garment_types \\(id, school_id, name, description, is_active, created_at, updated_at\\)\n    VALUES \\(gen_random_uuid\\(\\), confama_id, ''Camiseta'', ''Camiseta escolar CONFAMA'', true, NOW\\(\\), NOW\\(\\)\\)\n    RETURNING id INTO camiseta_id;\n    \n    INSERT INTO garment_types \\(id, school_id, name, description, is_active, created_at, updated_at\\)\n    VALUES \\(gen_random_uuid\\(\\), confama_id, ''Sudadera'', ''Sudadera escolar CONFAMA'', true, NOW\\(\\), NOW\\(\\)\\)\n    RETURNING id INTO sudadera_id;\n    \n    INSERT INTO garment_types \\(id, school_id, name, description, is_active, created_at, updated_at\\)\n    VALUES \\(gen_random_uuid\\(\\), confama_id, ''Chompa'', ''Chompa escolar CONFAMA'', true, NOW\\(\\), NOW\\(\\)\\)\n    RETURNING id INTO chompa_id;\n    \n    RAISE NOTICE ''Tipos de prenda creados: Camiseta=%, Sudadera=%, Chompa=%'', camiseta_id, sudadera_id, chompa_id;\n    \n    -- Crear productos CAMISETA \\(Tallas 2, 4, 6\\)\n    INSERT INTO products \\(id, school_id, garment_type_id, code, name, size, price, stock, is_active, created_at, updated_at\\)\n    VALUES \n        \\(gen_random_uuid\\(\\), confama_id, camiseta_id, ''CONF-CAM-02'', ''Camiseta Escolar'', ''2'', 34000, 0, true, NOW\\(\\), NOW\\(\\)\\),\n        \\(gen_random_uuid\\(\\), confama_id, camiseta_id, ''CONF-CAM-04'', ''Camiseta Escolar'', ''4'', 35000, 0, true, NOW\\(\\), NOW\\(\\)\\),\n        \\(gen_random_uuid\\(\\), confama_id, camiseta_id, ''CONF-CAM-06'', ''Camiseta Escolar'', ''6'', 39000, 0, true, NOW\\(\\), NOW\\(\\)\\);\n    \n    -- Crear productos SUDADERA \\(Tallas 2, 4, 6\\)\n    INSERT INTO products \\(id, school_id, garment_type_id, code, name, size, price, stock, is_active, created_at, updated_at\\)\n    VALUES \n        \\(gen_random_uuid\\(\\), confama_id, sudadera_id, ''CONF-SUD-02'', ''Sudadera Escolar'', ''2'', 35000, 0, true, NOW\\(\\), NOW\\(\\)\\),\n        \\(gen_random_uuid\\(\\), confama_id, sudadera_id, ''CONF-SUD-04'', ''Sudadera Escolar'', ''4'', 36000, 0, true, NOW\\(\\), NOW\\(\\)\\),\n        \\(gen_random_uuid\\(\\), confama_id, sudadera_id, ''CONF-SUD-06'', ''Sudadera Escolar'', ''6'', 40000, 0, true, NOW\\(\\), NOW\\(\\)\\);\n    \n    -- Crear productos CHOMPA \\(Tallas 2, 4, 6\\)\n    INSERT INTO products \\(id, school_id, garment_type_id, code, name, size, price, stock, is_active, created_at, updated_at\\)\n    VALUES \n        \\(gen_random_uuid\\(\\), confama_id, chompa_id, ''CONF-CHO-02'', ''Chompa Escolar'', ''2'', 42000, 0, true, NOW\\(\\), NOW\\(\\)\\),\n        \\(gen_random_uuid\\(\\), confama_id, chompa_id, ''CONF-CHO-04'', ''Chompa Escolar'', ''4'', 45000, 0, true, NOW\\(\\), NOW\\(\\)\\),\n        \\(gen_random_uuid\\(\\), confama_id, chompa_id, ''CONF-CHO-06'', ''Chompa Escolar'', ''6'', 49000, 0, true, NOW\\(\\), NOW\\(\\)\\);\n    \n    RAISE NOTICE ''Productos creados exitosamente para CONFAMA'';\nEND $$;\n\n-- Verificar productos creados\nSELECT p.code, p.name, p.size, p.price, gt.name as tipo \nFROM products p \nJOIN garment_types gt ON p.garment_type_id = gt.id \nJOIN schools s ON p.school_id = s.id \nWHERE s.name = ''CONFAMA''\nORDER BY gt.name, p.size;\nEOF\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"PGPASSWORD=Uniformes2025 psql -h localhost -U uniformes_user -d uniformes_db -c \"\"\\\\d garment_types\"\"\")",
      "Bash(SSHPASS='2-jR5H2g*XfY$tD4' sshpass -e ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o ConnectTimeout=20 root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git pull origin develop && source backend/venv/bin/activate && TEST_DATABASE_URL=''postgresql+asyncpg://uniformes_user:Uniformes2025@localhost:5432/uniformes_test'' python -m pytest backend/tests/api/ -v --tb=line 2>&1 | tail -60\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"PGPASSWORD=Uniformes2025 psql -h localhost -U uniformes_user -d uniformes_db -c \"\"\\\\d products\"\"\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"PGPASSWORD=Uniformes2025 psql -h localhost -U uniformes_user -d uniformes_db << ''EOF''\n-- Crear tipos de prenda para CONFAMA\nDO $$\nDECLARE\n    confama_id UUID := ''45a33bc8-a732-4208-b99f-91f100077114'';\n    camiseta_id UUID;\n    sudadera_id UUID;\n    chompa_id UUID;\nBEGIN\n    -- Crear tipos de prenda para CONFAMA\n    INSERT INTO garment_types \\(id, school_id, name, description, requires_embroidery, has_custom_measurements, is_active, created_at, updated_at\\)\n    VALUES \\(gen_random_uuid\\(\\), confama_id, ''Camiseta'', ''Camiseta escolar CONFAMA'', true, false, true, NOW\\(\\), NOW\\(\\)\\)\n    RETURNING id INTO camiseta_id;\n    \n    INSERT INTO garment_types \\(id, school_id, name, description, requires_embroidery, has_custom_measurements, is_active, created_at, updated_at\\)\n    VALUES \\(gen_random_uuid\\(\\), confama_id, ''Sudadera'', ''Sudadera escolar CONFAMA'', true, false, true, NOW\\(\\), NOW\\(\\)\\)\n    RETURNING id INTO sudadera_id;\n    \n    INSERT INTO garment_types \\(id, school_id, name, description, requires_embroidery, has_custom_measurements, is_active, created_at, updated_at\\)\n    VALUES \\(gen_random_uuid\\(\\), confama_id, ''Chompa'', ''Chompa escolar CONFAMA'', true, false, true, NOW\\(\\), NOW\\(\\)\\)\n    RETURNING id INTO chompa_id;\n    \n    RAISE NOTICE ''Tipos de prenda creados: Camiseta=%, Sudadera=%, Chompa=%'', camiseta_id, sudadera_id, chompa_id;\n    \n    -- Crear productos CAMISETA \\(Tallas 2, 4, 6\\)\n    INSERT INTO products \\(id, school_id, garment_type_id, code, name, size, price, is_active, created_at, updated_at\\)\n    VALUES \n        \\(gen_random_uuid\\(\\), confama_id, camiseta_id, ''CONF-CAM-02'', ''Camiseta Escolar'', ''2'', 34000, true, NOW\\(\\), NOW\\(\\)\\),\n        \\(gen_random_uuid\\(\\), confama_id, camiseta_id, ''CONF-CAM-04'', ''Camiseta Escolar'', ''4'', 35000, true, NOW\\(\\), NOW\\(\\)\\),\n        \\(gen_random_uuid\\(\\), confama_id, camiseta_id, ''CONF-CAM-06'', ''Camiseta Escolar'', ''6'', 39000, true, NOW\\(\\), NOW\\(\\)\\);\n    \n    -- Crear productos SUDADERA \\(Tallas 2, 4, 6\\)\n    INSERT INTO products \\(id, school_id, garment_type_id, code, name, size, price, is_active, created_at, updated_at\\)\n    VALUES \n        \\(gen_random_uuid\\(\\), confama_id, sudadera_id, ''CONF-SUD-02'', ''Sudadera Escolar'', ''2'', 35000, true, NOW\\(\\), NOW\\(\\)\\),\n        \\(gen_random_uuid\\(\\), confama_id, sudadera_id, ''CONF-SUD-04'', ''Sudadera Escolar'', ''4'', 36000, true, NOW\\(\\), NOW\\(\\)\\),\n        \\(gen_random_uuid\\(\\), confama_id, sudadera_id, ''CONF-SUD-06'', ''Sudadera Escolar'', ''6'', 40000, true, NOW\\(\\), NOW\\(\\)\\);\n    \n    -- Crear productos CHOMPA \\(Tallas 2, 4, 6\\)\n    INSERT INTO products \\(id, school_id, garment_type_id, code, name, size, price, is_active, created_at, updated_at\\)\n    VALUES \n        \\(gen_random_uuid\\(\\), confama_id, chompa_id, ''CONF-CHO-02'', ''Chompa Escolar'', ''2'', 42000, true, NOW\\(\\), NOW\\(\\)\\),\n        \\(gen_random_uuid\\(\\), confama_id, chompa_id, ''CONF-CHO-04'', ''Chompa Escolar'', ''4'', 45000, true, NOW\\(\\), NOW\\(\\)\\),\n        \\(gen_random_uuid\\(\\), confama_id, chompa_id, ''CONF-CHO-06'', ''Chompa Escolar'', ''6'', 49000, true, NOW\\(\\), NOW\\(\\)\\);\n    \n    RAISE NOTICE ''Productos CONFAMA creados exitosamente'';\nEND $$;\n\n-- Verificar productos creados\nSELECT p.code, p.name, p.size, p.price, gt.name as tipo \nFROM products p \nJOIN garment_types gt ON p.garment_type_id = gt.id \nJOIN schools s ON p.school_id = s.id \nWHERE s.name = ''CONFAMA''\nORDER BY gt.name, p.size;\nEOF\")",
      "Bash(SSHPASS='2-jR5H2g*XfY$tD4' sshpass -e ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o ConnectTimeout=20 root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git pull origin develop && source backend/venv/bin/activate && TEST_DATABASE_URL=''postgresql+asyncpg://uniformes_user:Uniformes2025@localhost:5432/uniformes_test'' python -m pytest backend/tests/api/ -v --tb=line 2>&1 | tail -30\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"PGPASSWORD=Uniformes2025 psql -h localhost -U uniformes_user -d uniformes_db << ''EOF''\n-- Ver precios actuales antes del cambio\nSELECT s.name as colegio, COUNT\\(*\\) as productos, MIN\\(p.price\\) as precio_min, MAX\\(p.price\\) as precio_max\nFROM products p\nJOIN schools s ON p.school_id = s.id\nGROUP BY s.name\nORDER BY s.name;\n\n-- Actualizar todos los precios: +3000\nUPDATE products SET price = price + 3000, updated_at = NOW\\(\\);\n\n-- Ver precios despuÃ©s del cambio\nSELECT s.name as colegio, COUNT\\(*\\) as productos, MIN\\(p.price\\) as precio_min_nuevo, MAX\\(p.price\\) as precio_max_nuevo\nFROM products p\nJOIN schools s ON p.school_id = s.id\nGROUP BY s.name\nORDER BY s.name;\nEOF\")",
      "Bash(SSHPASS='2-jR5H2g*XfY$tD4' sshpass -e ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o ConnectTimeout=20 root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git pull origin develop && source backend/venv/bin/activate && TEST_DATABASE_URL=''postgresql+asyncpg://uniformes_user:Uniformes2025@localhost:5432/uniformes_test'' python -m pytest backend/tests/api/ -v 2>&1 | tail -15\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"PGPASSWORD=Uniformes2025 psql -h localhost -U uniformes_user -d uniformes_db << ''EOF''\n-- Ver precios actuales de Yomber\nSELECT s.name as colegio, p.size, p.price as precio_actual\nFROM products p\nJOIN garment_types gt ON p.garment_type_id = gt.id\nJOIN schools s ON p.school_id = s.id\nWHERE gt.name = ''Yomber''\nORDER BY s.name, p.size;\n\n-- Aumentar 7000 adicionales a Yomber\nUPDATE products p\nSET price = price + 7000, updated_at = NOW\\(\\)\nFROM garment_types gt\nWHERE p.garment_type_id = gt.id AND gt.name = ''Yomber'';\n\n-- Ver precios nuevos de Yomber\nSELECT s.name as colegio, p.size, p.price as precio_nuevo\nFROM products p\nJOIN garment_types gt ON p.garment_type_id = gt.id\nJOIN schools s ON p.school_id = s.id\nWHERE gt.name = ''Yomber''\nORDER BY s.name, p.size;\nEOF\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"grep -n ''garment_type_id.*images'' /var/www/uniformes-system-v2/backend/app/api/routes/products.py | head -10\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"systemctl restart uniformes-api && sleep 3 && curl -s http://localhost:8000/api/v1/garment-types | head -500\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"curl -s http://localhost:8000/api/v1/schools/499b95b0-9126-42cf-a83b-a39f78624efc/garment-types/3d9ed414-ecba-4d19-9823-3a91198ce1b0/images\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"ls -la /var/www/uniformes-system-v2/uploads/garment-types/ 2>/dev/null || echo ''Directory not found''\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"find /var/www/uniformes-system-v2/uploads -name ''*.jpg'' -o -name ''*.png'' 2>/dev/null\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"cat /etc/nginx/sites-enabled/uniformes* 2>/dev/null | head -80\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"cat > /tmp/nginx_uploads.conf << ''EOF''\n    # Serve uploaded images\n    location /uploads/ {\n        alias /var/www/uniformes-system-v2/uploads/;\n        expires 30d;\n        add_header Cache-Control \"\"public, immutable\"\";\n        add_header Access-Control-Allow-Origin ''*'';\n    }\nEOF\ncat /tmp/nginx_uploads.conf\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"curl -I https://api.uniformesconsuelorios.com/uploads/garment-types/545e8991-e1f2-4c10-9315-adcdc74ce1f5/6fdd39ef-14f2-47f9-a94b-51cdf026ec62/img_20260104_160555_f9a28dc1.jpg 2>/dev/null | head -10\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"grep -A5 ''location /uploads'' /etc/nginx/sites-enabled/uniformes\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"journalctl -u uniformes-api -n 80 --no-pager | tail -80\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"journalctl -u uniformes-api -n 150 --no-pager 2>&1 | grep -A 30 ''Error\\\\|Exception\\\\|Traceback\\\\|500''\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"journalctl -u uniformes-api --since ''2 minutes ago'' --no-pager | grep -A 30 -E ''\\(ERROR|Traceback|Exception|500\\)''\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"journalctl -u uniformes-api --since ''5 minutes ago'' --no-pager 2>&1 | grep -A 100 ''with_images=true'' | head -120\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"sed -i ''s/query_options = \\\\[/# Build query options based on with_images flag\\\\n    if with_images:\\\\n        query_options = [\\\\n            selectinload\\(Product.garment_type\\).selectinload\\(GarmentType.images\\),\\\\n            joinedload\\(Product.school\\)\\\\n        ]\\\\n    else:\\\\n        query_options = [/'' /var/www/uniformes-system-v2/backend/app/api/routes/products.py\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"head -100 /var/www/uniformes-system-v2/backend/app/api/routes/products.py\")",
      "Bash(SSHPASS='2-jR5H2g*XfY$tD4' sshpass -e ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o ConnectTimeout=20 root@104.156.247.226 \"pm2 list && pm2 restart all\")",
      "Bash(NODE_ENV=production npm run build:*)",
      "Bash(rsync -avz --delete -e \"sshpass -p ''2-jR5H2g*XfY$tD4'' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no\" .next/ root@104.156.247.226:/var/www/uniformes-system-v2/web-portal/.next/)",
      "Bash(SSHPASS='2-jR5H2g*XfY$tD4' sshpass -e ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o ConnectTimeout=20 root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git pull origin develop && systemctl restart uniformes-api && echo ''API reiniciada exitosamente''\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"PGPASSWORD=Uniformes2025 psql -h localhost -U uniformes_user -d uniformes_db -c \"\"SELECT gt.id, gt.name, gt.school_id, s.name as school_name FROM garment_types gt JOIN schools s ON gt.school_id = s.id WHERE s.name = ''CONFAMA'' ORDER BY gt.name;\"\"\")",
      "Bash(SSHPASS='2-jR5H2g*XfY$tD4' sshpass -e ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o ConnectTimeout=20 root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git reset --hard HEAD && git clean -fd && git pull origin develop && systemctl restart uniformes-api && echo ''API reiniciada exitosamente''\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"curl -s ''http://localhost:8000/api/v1/global/products?limit=5'' | head -300\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && git log --oneline -3\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"curl -s ''http://localhost:8000/api/v1/products?limit=2&with_images=true''\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"curl -s http://localhost:8000/api/v1/global/products?limit=5 | python3 -m json.tool | head -100\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password root@104.156.247.226 \"systemctl restart uniformes-api && sleep 2 && systemctl status uniformes-api | head -10\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && cat backend/app/api/routes/global_accounting.py | grep -n ''summary-by-category'' -A 60 | head -70\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && grep -n ''ExpenseCategorySummary'' backend/app/schemas/accounting.py -A 15\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"cd /var/www/uniformes-system-v2/backend && source venv/bin/activate && alembic upgrade head\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && grep -n ''ExpenseCategory'' backend/app/models/accounting.py -B 2 -A 15 | head -30\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password -o PubkeyAuthentication=no root@104.156.247.226 \"PGPASSWORD=Uniformes2025 psql -h localhost -U uniformes_user -d uniformes_db << ''EOF''\n-- Add the column\nALTER TABLE schools ADD COLUMN display_order INTEGER DEFAULT 100 NOT NULL;\n\n-- Set initial order\nUPDATE schools SET display_order = 1 WHERE slug = ''caracas'' OR name ILIKE ''%caracas%'';\nUPDATE schools SET display_order = 2 WHERE slug = ''pumarejo'' OR name ILIKE ''%pumarejo%'';\nUPDATE schools SET display_order = 3 WHERE slug = ''pinal'' OR name ILIKE ''%pinal%'';\nUPDATE schools SET display_order = 4 WHERE slug = ''confama'' OR name ILIKE ''%confama%'';\n\n-- Mark migration as applied\nINSERT INTO alembic_version \\(version_num\\) VALUES \\(''p0q1r2s3t4u5''\\);\n\n-- Verify\nSELECT name, slug, display_order FROM schools ORDER BY display_order, name;\nEOF\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password root@104.156.247.226 \"cd /var/www/uniformes-system-v2 && head -60 backend/app/api/routes/global_accounting.py\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"PGPASSWORD=Uniformes2025 psql -h localhost -U uniformes_user -d uniformes_db -c ''SELECT gt.id, gt.name, gt.school_id, s.name as school FROM garment_types gt LEFT JOIN schools s ON gt.school_id = s.id ORDER BY s.name, gt.name;''\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password root@104.156.247.226 \"curl -s http://localhost:8000/docs\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password root@104.156.247.226 \"curl -s -w ''\\\\n\\\\nHTTP_CODE: %{http_code}'' ''http://localhost:8000/api/v1/global/accounting/expenses/summary-by-category?start_date=2026-01-01&end_date=2026-01-04'' -H ''Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0YzIyYWUzNi00NzNmLTQxNmMtYjRmNC1mYTA1OTA0N2M4NmQiLCJleHAiOjE3Njc2OTgzMjR9.WPOGBuKDv9tVukcsQtuFY5HCSq0Jo1E-k0_eGRbG6Ag''\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password root@104.156.247.226 \"cd /var/www/uniformes-system-v2/backend && source venv/bin/activate && python3 << ''EOF''\nfrom datetime import datetime, timedelta\nfrom jose import jwt\nfrom app.core.config import settings\n\n# Check algorithm and decode\nprint\\(f''ALGORITHM: {settings.ALGORITHM}''\\)\nprint\\(f''SECRET_KEY prefix: {settings.SECRET_KEY[:20]}...''\\)\n\n# Create token\ntoken_data = {\n    ''sub'': ''4c22ae36-473f-416c-b4f4-fa059047c86d'',\n    ''exp'': datetime.utcnow\\(\\) + timedelta\\(hours=24\\)\n}\ntoken = jwt.encode\\(token_data, settings.SECRET_KEY, algorithm=settings.ALGORITHM\\)\nprint\\(f''Token: {token[:50]}...''\\)\n\n# Try to decode it\ndecoded = jwt.decode\\(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM]\\)\nprint\\(f''Decoded: {decoded}''\\)\nEOF\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password root@104.156.247.226 \"cd /var/www/uniformes-system-v2/backend && source venv/bin/activate && python3 << ''EOF''\nfrom datetime import datetime, timedelta\nfrom jose import jwt\nfrom app.core.config import settings\n\ntoken_data = {\n    ''sub'': ''4c22ae36-473f-416c-b4f4-fa059047c86d'',\n    ''exp'': datetime.utcnow\\(\\) + timedelta\\(hours=24\\)\n}\ntoken = jwt.encode\\(token_data, settings.SECRET_KEY, algorithm=settings.ALGORITHM\\)\nprint\\(token\\)\nEOF\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password root@104.156.247.226 \"curl -s -w ''\\\\n\\\\nHTTP_CODE: %{http_code}'' ''http://localhost:8000/api/v1/global/accounting/expenses/summary-by-category?start_date=2026-01-01&end_date=2026-01-04'' -H ''Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0YzIyYWUzNi00NzNmLTQxNmMtYjRmNC1mYTA1OTA0N2M4NmQiLCJleHAiOjE3Njc2OTg0MjJ9.O3LJfx4UZQ1EnvZaER_EiKsTv1b-LYdj0Zfknr5zPZo''\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password root@104.156.247.226 \"cat /etc/systemd/system/uniformes-api.service\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"PGPASSWORD=Uniformes2025 psql -h localhost -U uniformes_user -d uniformes_db -c \"\"SELECT p.id, p.code, p.name, p.size, p.price, gt.name as garment_type FROM products p JOIN garment_types gt ON p.garment_type_id = gt.id WHERE p.school_id IS NULL ORDER BY gt.name, p.size;\"\"\")",
      "Bash(SSHPASS='2-jR5H2g*XfY$tD4' sshpass -e ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password root@104.156.247.226 \"cat /etc/systemd/system/uniformes-api.service\")",
      "Bash(sshpass -p '2-jR5H2g*XfY$tD4' ssh -o StrictHostKeyChecking=no root@104.156.247.226 \"PGPASSWORD=Uniformes2025 psql -h localhost -U uniformes_user -d uniformes_db << ''SQL''\n\\\\d garment_types\nSQL\")"
    ],
    "deny": [],
    "ask": []
  }
}
